There is an easier way to access arrays than the index calculations I do here.
Fix as needed.